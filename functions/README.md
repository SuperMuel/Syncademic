# Backend

The backend is built on Firebase Cloud Functions, Firebase Authentication, and Firebase Firestore. It is responsible for the following tasks:

- **Synchronization Process**: Automates the synchronization of events from the user's Time Schedule Source to their Target Calendar. This includes fetching the `.ICS` file, parsing events, applying customization rules generated by the AI, and updating the calendar with the modified events.

- **AI Integration**: Utilizes AI models to automatically generate Customization Rules based for each Sync Profile. 

- **Authorization Management**: Handles OAuth 2.0 authorization with calendar providers (currently Google Calendar). Manages access and refresh tokens securely to perform operations on behalf of the user.

- **Validation Services**: Provides endpoints to validate the Time Schedule Source URLs and ensure the `.ICS` files are correctly formatted and accessible.

- **Scheduled Tasks**: Sets up scheduled functions to perform periodic synchronizations and clean-up operations without user intervention.

- **API Endpoints**: Exposes callable HTTPS functions for frontend interaction, including:
  - **Requesting Synchronization**: Allows users to manually trigger synchronization.
  - **Backend Authorization**: Enables the frontend to securely pass authorization codes for backend access.

# Deploy

## Exporting `requirements.txt`

Firebase Cloud Functions cannot use `poetry` to manage dependencies but uses `requirements.txt` instead. Thus, we need to convert the `pyproject.toml` file to `requirements.txt` before each deployment.

1. Install Poetry "Export" plugin
```bash
poetry self add poetry-export
```

2. Inside the `functions` directory, run : 
```bash
poetry export --without-hashes -f requirements.txt -o requirements.txt
```